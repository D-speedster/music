# 🎵 ربات ویرایش فایل‌های صوتی

ربات پیشرفته تلگرام برای ویرایش متادیتا و کاور فایل‌های صوتی با استفاده از Telethon

## ✨ امکانات

### 🟢 امکانات اصلی
- **آپلود فایل صوتی**: پشتیبانی از MP3, FLAC, WAV, M4A, OGG, AAC
- **ویرایش تگ‌های ID3/Metadata**:
  - تغییر نام آهنگ (Title)
  - تغییر نام هنرمند (Artist)
  - تغییر آلبوم (Album)
  - تغییر ژانر (Genre)
  - تغییر سال انتشار (Year)
  - تغییر Track Number
- **ویرایش کاور آلبوم**:
  - اضافه کردن کاور جدید
  - حذف کاور موجود
  - جایگزینی کاور
  - استخراج کاور موجود
- **ویرایش نام فایل خروجی**: شخصی‌سازی نام فایل با قالب‌های مختلف
- **محدودیت حجم**: تا 2GB (محدودیت تلگرام)

### 🟡 امکانات پیشرفته (آینده)
- تبدیل فرمت فایل
- تغییر بیت‌ریت و کیفیت
- پیش‌تنظیمات (Templates)
- اتصال به دیتابیس موزیک آنلاین
- ویرایش گروهی (Batch Edit)
- پنل مدیریت ادمین

## 🚀 نصب و راه‌اندازی

### پیش‌نیازها
```bash
pip install -r requirements.txt
```

### تنظیمات

#### 1. دریافت اطلاعات API
- به [my.telegram.org](https://my.telegram.org) بروید
- وارد شوید و API ID و API Hash خود را دریافت کنید
- از [@BotFather](https://t.me/BotFather) یک ربات جدید ایجاد کنید و توکن آن را دریافت کنید

#### 2. تنظیم فایل .env
فایل `.env.example` را کپی کرده و نام آن را به `.env` تغییر دهید:
```bash
cp .env.example .env
```

سپس مقادیر واقعی را وارد کنید:
```env
BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
API_ID=12345678
API_HASH=abcdef1234567890abcdef1234567890
ADMIN_USER_ID=123456789
```

2. دایرکتوری‌های مورد نیاز ایجاد می‌شوند:
   - `temp/` - فایل‌های موقت
   - `output/` - فایل‌های خروجی

### اجرا
```bash
python music_bot.py
```

#### تست اتصال
برای تست اتصال و عملکرد اولیه:
```bash
python test_bot.py
```

## 📖 نحوه استفاده

1. **شروع**: `/start` - نمایش پیام خوش‌آمدگویی
2. **راهنما**: `/help` - راهنمای کامل
3. **لغو**: `/cancel` - لغو عملیات جاری

### مراحل ویرایش:
1. فایل صوتی خود را ارسال کنید
2. از منوی ظاهر شده، نوع ویرایش را انتخاب کنید
3. اطلاعات جدید را وارد کنید
4. فایل ویرایش شده را دریافت کنید

## 🏗️ ساختار پروژه

```
Music/
├── music_bot.py          # ربات اصلی Telethon
├── audio_editor.py       # کلاس ویرایش فایل‌های صوتی
├── config.py            # تنظیمات و پیکربندی
├── requirements.txt     # وابستگی‌های پایتون
├── .env                # متغیرهای محیطی
├── README.md           # مستندات
├── temp/               # فایل‌های موقت
└── output/             # فایل‌های خروجی
```

## 🔧 کلاس‌ها و توابع اصلی

### AudioEditor
- `load_file()` - بارگذاری فایل صوتی
- `get_metadata()` - استخراج متادیتا
- `update_metadata()` - به‌روزرسانی متادیتا
- `add_cover_art()` - اضافه کردن کاور
- `remove_cover_art()` - حذف کاور
- `extract_cover_art()` - استخراج کاور
- `generate_filename()` - تولید نام فایل

### MusicBot
- `handle_start()` - پردازش دستور شروع
- `handle_document()` - پردازش فایل‌های ارسالی
- `show_main_menu()` - نمایش منوی اصلی
- `handle_callback()` - پردازش callback query ها
- `save_and_download()` - ذخیره و ارسال فایل

## 🎯 قالب‌های نام فایل

می‌توانید از متغیرهای زیر استفاده کنید:
- `{title}` - نام آهنگ
- `{artist}` - نام هنرمند
- `{album}` - نام آلبوم
- `{year}` - سال انتشار
- `{track}` - شماره ترک
- `{genre}` - ژانر

**مثال‌ها:**
- `{artist} - {title}`
- `{title} ({year})`
- `{album} - {track} - {title}`

## 🛡️ امنیت

- تمام فایل‌های موقت پس از پردازش حذف می‌شوند
- محدودیت حجم فایل برای جلوگیری از سوء استفاده
- پشتیبانی از فرمت‌های امن فایل

## 🐛 عیب‌یابی

### مشکلات رایج:
1. **خطای اتصال**: API_ID و API_HASH را بررسی کنید
2. **فرمت پشتیبانی نمی‌شود**: فقط فرمت‌های صوتی مجاز هستند
3. **حجم زیاد**: حداکثر 2GB

### لاگ‌ها:
ربات تمام فعالیت‌ها را لاگ می‌کند. برای دیدن جزئیات بیشتر:
```python
logging.basicConfig(level=logging.DEBUG)
```

## 📝 مجوز

این پروژه تحت مجوز MIT منتشر شده است.

## 🤝 مشارکت

برای مشارکت در توسعه:
1. Fork کنید
2. Branch جدید ایجاد کنید
3. تغییرات را commit کنید
4. Pull Request ارسال کنید

## 📞 پشتیبانی

برای گزارش باگ یا درخواست ویژگی جدید، Issue ایجاد کنید.